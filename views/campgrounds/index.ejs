<% layout('layouts/boilerplate.ejs') %> 

    <div id="cluster-map" >
        <!-- to show cluster map -->
    </div>

    <div> 
        <!-- searching a campground -->
        <form method="GET" action="/campgrounds" >
            <input class="search" type="search" placeholder="Search" aria-label="Search" name="search">
            <button>Go</button> 
        </form>
    </div>

    <% if(sstring){%>
        <h2>Search term:'<%=sstring%>'</h2>
    <%}%>

    <!-- if we found no match for the search string -->
    <%if(noMatch!==null){%>
        <h1>No matches found for <%=noMatch%>!</h1>
    <% }%>

    <% if(noMatch==null){%>
    <h1>List of Campgrounds</h1>
    <%}%>

    

    <!-- <div>
        <a href="/campgrounds/new">Add New Campground</a>
    </div> -->
    
    <%for (let campground of campgrounds){%>
     <div class="card m-3 p-3">
        <div class="row">
            <div class="col-md-4">
                <% if (campground.images.length){%> 
                <img src="<%=campground.images[0].cropped%>" alt="" class="img-fluid">
                <!--cropped is using virtual on models/campgrounds to give a 4:3 image-->
                <% } else { %>
                    <img src="https://res.cloudinary.com/dvhs0ay92/image/upload/v1632152649/YelpCamp/photo-1564577160324-112d603f750f_memk84.jpg" alt="" class="img-fluid">
                <% } %> 
                    
            </div>
            <div class="col-md-8">
            <h5><%=campground.title%></h5>
            <p><%=campground.description%></p>
            <h6 class="text-muted"><%=campground.location%></h6>
            <a class="btn btn-primary" href="/campgrounds/<%=campground._id%>">View Details</a>
            </div>

        </div>


     </div>       

    <%}%>
    
   <script> 
        const mapToken= '<%-process.env.MAPBOX_TOKEN%>';
        
        const campgrounds= {features: <%-JSON.stringify(campgrounds)%>};
         
   </script> 
   <script src="/javascripts/clusterMap.js"></script>

  